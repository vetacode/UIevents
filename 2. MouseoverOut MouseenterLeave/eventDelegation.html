<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <!-- <link rel="stylesheet" href="style.css"> -->
    <style>
      #text {
        display: block;
        height: 100px;
        width: 456px;
      }

      #table th {
        text-align: center;
        font-weight: bold;
      }

      #table td {
        width: 150px;
        white-space: nowrap;
        text-align: center;
        vertical-align: bottom;
        padding-top: 5px;
        padding-bottom: 12px;
        cursor: pointer;
      }

      #table .nw {
        background: #999;
      }

      #table .n {
        background: #03f;
        color: #fff;
      }

      #table .ne {
        background: #ff6;
      }

      #table .w {
        background: #ff0;
      }

      #table .c {
        background: #60c;
        color: #fff;
      }

      #table .e {
        background: #09f;
        color: #fff;
      }

      #table .sw {
        background: #963;
        color: #fff;
      }

      #table .s {
        background: #f60;
        color: #fff;
      }

      #table .se {
        background: #0c3;
        color: #fff;
      }

      #table .highlight {
        background: red;
      }
    </style>
  </head>

  <body>
    <table id="table">
      <tr>
        <th colspan="3">
          <em>Bagua</em> Chart: Direction, Element, Color, Meaning
        </th>
      </tr>
      <tr>
        <td class="nw">
          <strong>Northwest</strong> <br />Metal <br />Silver <br />Elders
        </td>
        <td class="n">
          <strong>North</strong> <br />Water <br />Blue <br />Change
        </td>
        <td class="ne">
          <strong>Northeast</strong> <br />Earth <br />Yellow <br />Direction
        </td>
      </tr>
      <tr>
        <td class="w">
          <strong>West</strong> <br />Metal <br />Gold <br />Youth
        </td>
        <td class="c">
          <strong>Center</strong> <br />All <br />Purple <br />Harmony
        </td>
        <td class="e">
          <strong>East</strong> <br />Wood <br />Blue <br />Future
        </td>
      </tr>
      <tr>
        <td class="sw">
          <strong>Southwest</strong> <br />Earth <br />Brown <br />Tranquility
        </td>
        <td class="s">
          <strong>South</strong> <br />Fire <br />Orange <br />Fame
        </td>
        <td class="se">
          <strong>Southeast</strong> <br />Wood <br />Green <br />Romance
        </td>
      </tr>
    </table>

    <textarea id="text"></textarea>

    <input type="button" onclick="text.value=''" value="Clear" />

    <!-- <script src="script.js"></script> -->
    <script>
      // table.onmouseover = function (event) {
      //   let target = event.target;
      //   target.style.background = 'pink';

      //   text.value += `over -> ${target.tagName}\n`;
      //   text.scrollTop = text.scrollHeight;
      // };

      // table.onmouseout = function (event) {
      //   let target = event.target;
      //   target.style.background = '';

      //   text.value += `out <- ${target.tagName}\n`;
      //   text.scrollTop = text.scrollHeight;
      // };

      //USE EVENT DELEGATION
      // <td> under the mouse right now (if any)
      let currentElem = null;

      table.onmouseover = function (event) {
        // before entering a new element, the mouse always leaves the previous one
        // if currentElem is set, we didn't leave the previous <td>,
        // that's a mouseover inside it, ignore the event
        if (currentElem) return;

        let target = event.target.closest('td');

        // we moved not into a <td> - ignore
        if (!target) return;

        // moved into <td>, but outside of our table (possible in case of nested tables)
        // ignore
        if (!table.contains(target)) return;

        // hooray! we entered a new <td>
        currentElem = target;
        onEnter(currentElem);
      };

      table.onmouseout = function (event) {
        // if we're outside of any <td> now, then ignore the event
        // that's probably a move inside the table, but out of <td>,
        // e.g. from <tr> to another <tr>
        if (!currentElem) return;

        // we're leaving the element – where to? Maybe to a descendant?
        let relatedTarget = event.relatedTarget;

        while (relatedTarget) {
          // go up the parent chain and check – if we're still inside currentElem
          // then that's an internal transition – ignore it
          if (relatedTarget == currentElem) return;

          relatedTarget = relatedTarget.parentNode;
        }

        // we left the <td>. really.
        onLeave(currentElem);
        currentElem = null;
      };

      // any functions to handle entering/leaving an element
      function onEnter(elem) {
        elem.style.background = 'pink';

        // show that in textarea
        text.value += `over -> ${currentElem.tagName}.${currentElem.className}\n`;
        text.scrollTop = 1e6;
      }

      function onLeave(elem) {
        elem.style.background = '';

        // show that in textarea
        text.value += `out <- ${elem.tagName}.${elem.className}\n`;
        text.scrollTop = 1e6;
      }
    </script>
  </body>
</html>
